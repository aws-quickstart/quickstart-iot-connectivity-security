== Postdeployment steps

As soon as the AWS CloudFormation stack completes, follow these steps:

. Under the *Outputs* tab, note the *DefaultDomain* value. You need this value to view the web application in a later step. 
. Wait for the web-application deployment process to complete. This process uses AWS Amplify to set up the web application. This process takes about 10 minutes. You can check the CloudFormation stack's status to verfiy the deployment. 
.. Open the AWS Amplify console, and choose the web application, to open it.
. Once you are on the web application, create an account using the *DefaultDomain* value. 
. (Optional) Set up a custom domain for the web application, with the https://docs.aws.amazon.com/amplify/latest/userguide/custom-domains.html[Set up a custom domain^] documentation.

== Test the deployment

=== Verify the deployment

. Sign in to the AWS Management Console, and open the AWS IoT console.

. Choose *Manage*, *Thing groups*. Verify that the *prebuilt thing* groups appear (for example, `iotquickstart-Active`, `iotquickstart-inactive`, and `iotquickstart-Quarantine`).

. Choose *Defend*, *Audit*, *Schedules*. Verify that a daily https://docs.aws.amazon.com/iot/latest/developerguide/device-defender-audit.html[audit^] appears (for example, `dailyaudit-main`).

. Choose *Defend*, *Detect*, *Security profiles*. Verify that an https://docs.aws.amazon.com/iot/latest/developerguide/dd-detect-ml.html[ML Detect^] security profile appears (for example, `SecurityProfile-152920-main`). This indicates that device behavior is monitored continuously.

=== Verify the just-in-time registration process for IoT devices

. https://docs.aws.amazon.com/iot/latest/developerguide/iot-connect-devices.html[Connect devices to AWS IoT^].
+
When an IoT device connects, the Quick Start performs the following actions: 
+
* Generates an AWS IoT device using the common name (serial number) from the device's certificate.
* Attaches the certificate to the IoT device.
* Creates an AWS DynamoDB entry using the common name.
* Adds the IoT device to the `iotquickstart-inactive` group with limited permissions.
* Activates the device certificate.
+
. Open the AWS IoT console, and choose *Manage*, *Things*. 
. Verify the IoT device's certificate and group affiliation. You can identify each IoT device by its certificate and common name (serial number).

For more information, see https://aws.amazon.com/blogs/iot/just-in-time-registration-of-device-certificates-on-aws-iot/[Just-in-Time Registration of Device Certificates on AWS IoT^].

=== Verify the registration process for the IoT devices 
Verify the device registration process by testing it with a single device. 

. Sign in to the AWS Management Console, and open the AWS Amplify console.  
. Under *All apps*, choose *iotquickstart*.
. Under the *Frontend environments* tab, choose the web application's thumbnail. A new browser tab opens with a sign-up page.
. Create an account.
. Log in with your account credentials. A *Register device* page appears.
. Enter your device's serial number, and choose *REGISTER DEVICE*. A message appears, indicating that the device is registered.
. In the left-hand pane, choose *Devices*. Verify that the registered device appears under *My Devices*.

//TODO Miles, What's an "end-user IoT device" (vs. just "IoT device" or "your device")? - good question I removed end-use from the title becuase it can be any IoT device that is registered, but leaving this comment in so we can talk about it durning the meeting

== Migrate to a production environment

. Use https://docs.aws.amazon.com/codecommit/latest/userguide/welcome.html[AWS CodeCommit] to customize the web application so that it meets your business needs.

. Onboard your IoT devices at the expected device-connection rate so that you can validate the deployment's processing rate and scale. For resource and API quotas, see https://docs.aws.amazon.com/general/latest/gr/iot-core.html[AWS IoT Core endpoints and quota^].

. Deploy this Quick Start to your production environment.
// So we will talk about this during the meeting, but I think the issue here is we need to show what the difference between a prod and non-prod deployment looks like. Will need Cathy's input here, going to leave the TODO's up.
//TODO Miles, How is Step 1 related to migrating to a production environment? Should this step go in a section called "Customize the web application"? 

//TODO Miles, Step 2 doesn't seem related to migrating to a production environment either. Should this go under "Postdeployment steps"?

//TODO Miles, For Step 3, do we follow the same steps documented under "Launch the Quick Start"? What do people need to know about migrating to a production environment? We need to give a bit of context hereâ€”and earlier if we weren't supposed to launch to production at first.

== Clean up

If you no longer need to register IoT devices using the web application that was created by this Quick Start, delete the web application as follows:

. Open the AWS Amplify console, choose the web application, and delete it.
. Open the AWS CloudFormation console, choose the associated stacks, and delete them.

If you you wish to redeploy the web application, follow use steps in the deployment section to redeploy the web application.  